[ソフトウェア名] InstantTextInserter
[  バージョン  ] 0.0.5
[    作者名    ] shouh
[   取扱種別   ] フリーウェア
[   動作環境   ] Windows7(32bit, 64bit)

■概要
定型文貼り付けソフトウェアです。
短縮形と定型文の組を登録しておくと、
短縮形を入力するだけで定型文が貼り付けられます。
# MacOS の TextExpander みたいなソフトです

メールアドレス、住所や郵便番号、挨拶文、プログラムコードなど
お決まりの文章を登録しておくと、素早く入力できて便利です。

類似ソフトとの違い
- 余計な機能や設定を省いてなるべくシンプルにしてある
- 定型文データをテキストファイルで管理
 - GUI から一件ずつ登録していく手間が無い
 - データの管理や共有が容易

■インストール
ダウンロードした圧縮ファイルを適当なフォルダ内で解凍します。

■アンインストール
インストールフォルダごと削除します。
インストールフォルダ以外のフォルダやレジストリは使用していません。

■使い方
スニペット(短縮形と定型文の組)を登録した後に
実行ファイルを起動するだけです。

スニペットに関する詳細は下記を参照してください。

スニペット編集後、プログラムに反映させるためにはリロードが必要です。
タスクトレイアイコンの右クリックメニュー、あるいは左クリックから行えます。

■とりあえずどんな感じなのか触ってみたい場合
既にスニペットをいくつか登録していますので、試用してみましょう。
実行ファイルを起動した後、メモ帳を開き、
'yr@' と入力してみてください。
「よろしくお願い致します。」という定型文が入力されると思います。

今度は 'a^^' と入力してみましょう。
「<a href=""></a>」が入力されると思います。
注目していただきたいのは、キャレット(カーソル)の位置です。

   <a href="">|</a>
              ^
              ここ

ここに来ていると思います。
定型文を単に入力するだけでなく、
入力後のカーソル位置を決めることもできるのです。

■スニペットの登録方法
用語
短縮形            : 定型文を貼り付けるために入力する文字列
定型文            : 実際に貼り付ける文字列
スニペット        : 短縮形と定型文の組

スニペットを登録するには snippet フォルダ直下に
テキストファイル(スニペットファイル)を作ります。
※ファイルの文字コードは Shift-Jis のみ使用可です
  他の文字コードを使うと文字化けが発生します

スニペットファイルは複数個作ることができます。
定型文の種類に応じて適宜分類すると良いでしょう。
例)
people.txt  : 人の名前関連
html_css.txt : HTMLタグ, CSS関連
accounts.txt  : アカウント, ID関連

■スニペットファイルの書き方
以下のように記述します。
(先頭のタブ文字は見易さのために入れてるだけなので不要です)

	===短縮形1===
	定型文1
	===短縮形2===
	定型文2
	…

'=' は一つ以上であれば何個でも構いません。
たとえば以下のような書き方もできます。

	=短縮形1=
	定型文1
	========短縮形2========
	定型文2
	…

短縮形に使用できる文字は以下のとおりです。
・0-9
・a-z
・タブ
・スペース
・記号(-^\@[;:],.\ など)

定型文中ではマクロ(% で囲まれた特殊な文字列)を使うことができます。
以下のマクロがサポートされています。

	%cursor% : 定型文貼付後, カーソルをこの位置に移動させる
	%equal%  : '=' が展開される(定型文行頭に '=' を入れたい場合に使う)
	%yyyy%   : 現在の年(4ケタ)
	%yy%     : 現在の年(2ケタ)
	%momo%   : 現在の月(2ケタ)
	%dd%     : 現在の日(2ケタ)
	%yj%     : 現在の曜日(日本語)
	%ye%     : 現在の曜日(英語、先頭三文字)
	%hh%     : 現在の時(2ケタ)
	%momo%   : 現在の分(2ケタ)
	%dd%     : 現在の秒(2ケタ)

■ホットキーについて
本ソフトウェアに関する操作のいくつは、
ホットキーで呼び出すことができます。
# ホットキーを使わずともタスクトレイアイコンから操作できるので、
# 無理にホットキーを使う必要はありません

ホットキーの設定は hotkey.ini を編集することで行います。
書き方は、一行毎に以下の形式で記述します。

	(設定項目),(割り当てる修飾キー),(割り当てるキー)
	;(先頭が';'だとコメントになります)

設定項目として使える文字列は hotkey.ini を参照してください。

割り当てる修飾キーとして使えるのは c, s, a, w の四つの文字です。
これを組み合わせて指定します。
たとえば Ctrl + Shift を設定したいなら cs や sc と書きます。

割り当てるキーとして使えるのは以下のとおりです。
	a-z
	0-9(メインキー)
	n0-n9(テンキー)
	F1-F24
	backspace
	tab
	enter
	pause
	capslock
	escape
	convert
	nonconvert
	space
	pageup
	pagedown
	end
	home
	left
	right
	up
	down
	printscreen
	insert
	delete

hotkey.ini の編集を終えた後は、リロードを行う必要があります。
トレイアイコンの右クリックメニュー or ホットキーから行えます。
リロードの際、設定の書き方がおかしかったり、
既に登録されていて登録できなかったりした場合はエラーとなり、
その設定は無視されます。

■Q&A
Q:短縮形を上手く登録するコツはありますか？
A:記号を使って誤入力を防ぐのがコツだと思います。
  たとえば「いつもお世話になっております」を登録したい場合、
  短縮形は it などが考えられますが、これだと
  行ってきますと入力した場合でも
  ittekimasu
  ~~
  この時点で貼り付けられてしまいます。
  これを防ぐために、たとえば it@ のように末尾に記号を入れてやります。

Q:定型文貼り付け後、クリップボード内容が消えたのですが....
A:v0.0.4までは、定型文貼り付けの度にクリップボード内容が
  定型文内容に置き換わるという仕様でした。
  (定型文を貼り付けるのにクリップボードを利用しているからです)
  が、v0.0.5 にて本仕様を改善し、
  元々存在していた内容を復旧するようにしています。
  ただ、完全な作り込みができておらず、状況によっては
  復旧できないケースがあります。

■転載, 配布
メールにてご相談ください。
なお、ウェブサイトでの本ソフトウェアの紹介は自由です。

■注意事項
本ソフトウェアを使用あるいは使用できなかったことによって
生じた損害について、作者は責任を負いません。

本ソフトウェアの仕様、名称、公開形態及び本テキストファイルの内容は
予告無く変更されることがあります。

全ての書き込みやメールに対して作者が対応するとは限りませんので
ご了承ください。

■連絡先
メールアドレス
  shouhpublicATTOgmailDOTTOcom
  ※大文字部分を記号に変換してください

ウェブサイト
  https://sites.google.com/site/shouhmisc/
  https://github.com/shouh/InstantTextInserter (ソースコード)

■更新履歴
15/??/?? v0.0.5 仕様変更
・定型文挿入時、元々のクリップボード内容を復旧するようにした

14/09/21 v0.0.4 機能追加
・現在日付や現在時刻に展開されるマクロを追加

14/09/21 v0.0.3 バグ修正
・hotkey.iniのコメントアウトがコメントアウトとして扱われてなかった不具合を修正
・対応する文字コードを Shift-Jis のみに限定
・環境によっては応答を受け付けなくなることがあった不具合を修正
  (文字コード関係の変換処理にしくじりメインスレッドが異常終了していた)
・%cursor% の位置が正しく計算されないことがあった不具合を修正

14/03/09 v0.0.2 機能追加と性能改善
・ホットキー機能を追加
・CPU使用率を抑制

13/01/06 v0.0.1
・とりあえず公開
